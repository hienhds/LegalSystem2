{
	"info": {
		"_postman_id": "appointment-api-collection-v2",
		"name": "Legal System - Appointment APIs",
		"description": "Complete collection of Appointment & Lawyer Schedule APIs for User Service\n\n**Cách sử dụng:**\n1. Register → auto-save userId\n2. Login → auto-save accessToken\n3. Tất cả requests khác tự động dùng Bearer token\n\n**Service:** User Service (Port 8081)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"version": "2.0.0"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{accessToken}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "userServiceUrl",
			"value": "http://localhost:8081",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "refreshToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		},
		{
			"key": "lawyerId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "appointmentId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "availabilityId",
			"value": "1",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201 || pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.userId) {",
									"        pm.environment.set('userId', jsonData.data.userId);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"citizen@example.com\",\n    \"password\": \"12345678\",\n    \"fullName\": \"Nguyen Van A\",\n    \"phoneNumber\": \"0987654321\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/auth/register",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data) {",
									"        pm.environment.set('accessToken', jsonData.data.accessToken);",
									"        pm.environment.set('refreshToken', jsonData.data.refreshToken);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"citizen@example.com\",\n    \"password\": \"12345678\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/auth/login",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				}
			]
		},
		{
			"name": "Appointment Management",
			"item": [
				{
					"name": "Create Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"lawyerId\": 1,\n    \"appointmentDate\": \"2025-12-30\",\n    \"appointmentTime\": \"10:00:00\",\n    \"description\": \"Tư vấn về tranh chấp hợp đồng lao động\",\n    \"consultationType\": \"ONLINE\",\n    \"meetingLocation\": \"Zoom Meeting\",\n    \"durationMinutes\": 60\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments"]
						}
					}
				},
				{
					"name": "Get My Appointments",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/my-appointments?page=0&size=10&status=PENDING",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "my-appointments"],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "status",
									"value": "PENDING"
								}
							]
						}
					}
				},
				{
					"name": "Get Lawyer Appointments",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/lawyer-appointments?page=0&size=10&status=PENDING",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "lawyer-appointments"],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "10"
								},
								{
									"key": "status",
									"value": "PENDING"
								}
							]
						}
					}
				},
				{
					"name": "Get Appointment By ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}?isLawyer=false",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}"],
							"query": [
								{
									"key": "isLawyer",
									"value": "false"
								}
							]
						}
					}
				},
				{
					"name": "Confirm Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"message\": \"Tôi đã xác nhận lịch hẹn. Hẹn gặp bạn đúng giờ!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}/confirm",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}", "confirm"]
						}
					}
				},
				{
					"name": "Reject Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"reason\": \"Xin lỗi, tôi có việc đột xuất vào thời gian này.\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}/reject",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}", "reject"]
						}
					}
				},
				{
					"name": "Cancel Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"reason\": \"Tôi có việc đột xuất, xin lỗi vì sự bất tiện này.\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}/cancel?isLawyer=false",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}", "cancel"],
							"query": [
								{
									"key": "isLawyer",
									"value": "false"
								}
							]
						}
					}
				},
				{
					"name": "Complete Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}/complete",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}", "complete"]
						}
					}
				},
				{
					"name": "Rate Appointment",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"rating\": 5,\n    \"comment\": \"Luật sư tư vấn rất nhiệt tình và chuyên nghiệp. Rất hài lòng!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/appointments/{{appointmentId}}/rate",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "appointments", "{{appointmentId}}", "rate"]
						}
					}
				}
			]
		},
		{
			"name": "Lawyer Schedule Management",
			"item": [
				{
					"name": "Create Availability",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"dayOfWeek\": 1,\n    \"startTime\": \"09:00:00\",\n    \"endTime\": \"17:00:00\",\n    \"isActive\": true,\n    \"timeZone\": \"Asia/Ho_Chi_Minh\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/availability",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "availability"]
						}
					}
				},
				{
					"name": "Create Bulk Availability (Multiple Days)",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"dayOfWeeks\": [1, 2, 3, 4, 5],\n    \"startTime\": \"09:00:00\",\n    \"endTime\": \"17:00:00\",\n    \"isActive\": true,\n    \"timeZone\": \"Asia/Ho_Chi_Minh\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/availability/bulk",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "availability", "bulk"]
						}
					}
				},
				{
					"name": "Update Availability",
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"dayOfWeek\": 1,\n    \"startTime\": \"08:00:00\",\n    \"endTime\": \"18:00:00\",\n    \"isActive\": true,\n    \"timeZone\": \"Asia/Ho_Chi_Minh\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/availability/{{availabilityId}}",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "availability", "{{availabilityId}}"]
						}
					}
				},
				{
					"name": "Delete Availability",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/availability/{{availabilityId}}",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "availability", "{{availabilityId}}"]
						}
					}
				},
				{
					"name": "Get My Availability",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/my-availability?activeOnly=true",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "my-availability"],
							"query": [
								{
									"key": "activeOnly",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get Lawyer Availability",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/availability/lawyer/{{lawyerId}}?activeOnly=true",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "availability", "lawyer", "{{lawyerId}}"],
							"query": [
								{
									"key": "activeOnly",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get Available Slots",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{userServiceUrl}}/api/lawyer-schedule/available-slots/lawyer/{{lawyerId}}?date=2025-12-30&durationMinutes=60",
							"host": ["{{userServiceUrl}}"],
							"path": ["api", "lawyer-schedule", "available-slots", "lawyer", "{{lawyerId}}"],
							"query": [
								{
									"key": "date",
									"value": "2025-12-30"
								},
								{
									"key": "durationMinutes",
									"value": "60"
								}
							]
						}
					}
				}
			]
		}
	]
}
